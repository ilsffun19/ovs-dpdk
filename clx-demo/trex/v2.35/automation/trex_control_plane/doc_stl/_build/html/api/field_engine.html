<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Field Engine modules &mdash; TRex Stateless Python API 1.7.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/no_scrollbars.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TRex Stateless Python API 1.7.1 documentation" href="../index.html" />
    <link rel="up" title="TRex Stateless API Reference" href="index.html" />
    <link rel="prev" title="Packet builder modules" href="scapy_builder.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="scapy_builder.html" title="Packet builder modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TRex Stateless Python API 1.7.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">TRex Stateless API Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="field-engine-modules">
<h1>Field Engine modules<a class="headerlink" href="#field-engine-modules" title="Permalink to this headline">¶</a></h1>
<p>The Field Engine (FE) has limited number of instructions/operation for supporting most use cases.
There is a plan to add LuaJIT to be more flexible at the cost of performance.
The FE can allocate stream variables in a Stream context, write a stream variable to a packet offset, change packet size,  etc.</p>
<p><em>Some examples for what can be done:</em></p>
<ul class="simple">
<li>Change ipv4.tos 1-10</li>
<li>Change packet size to be random in the range 64-9K</li>
<li>Create range of flows (change src_ip, dest_ip, src_port, dest_port)</li>
<li>Update IPv4 checksum</li>
</ul>
<p>Snippet will create SYN Attack:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># create attack from random src_ip from 16.0.0.0-18.0.0.254 and random src_port 1025-65000</span>
<span class="c"># attack 48.0.0.1 server</span>

<span class="k">def</span> <span class="nf">create_stream</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>


    <span class="c"># TCP SYN</span>
    <span class="n">base_pkt</span>  <span class="o">=</span> <span class="n">Ether</span><span class="p">()</span><span class="o">/</span><span class="n">IP</span><span class="p">(</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">TCP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="s">&quot;S&quot;</span><span class="p">)</span>


    <span class="c"># vm</span>
    <span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span> <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;ip_src&quot;</span><span class="p">,</span>
                                          <span class="n">min_value</span><span class="o">=</span><span class="s">&quot;16.0.0.0&quot;</span><span class="p">,</span>
                                          <span class="n">max_value</span><span class="o">=</span><span class="s">&quot;18.0.0.254&quot;</span><span class="p">,</span>
                                          <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;random&quot;</span><span class="p">),</span>

                        <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;src_port&quot;</span><span class="p">,</span>
                                          <span class="n">min_value</span><span class="o">=</span><span class="mi">1025</span><span class="p">,</span>
                                          <span class="n">max_value</span><span class="o">=</span><span class="mi">65000</span><span class="p">,</span>
                                          <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;random&quot;</span><span class="p">),</span>

                       <span class="n">STLVmWrFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;ip_src&quot;</span><span class="p">,</span> <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;IP.src&quot;</span> <span class="p">),</span>

                       <span class="n">STLVmFixIpv4</span><span class="p">(</span><span class="n">offset</span> <span class="o">=</span> <span class="s">&quot;IP&quot;</span><span class="p">),</span> <span class="c"># fix checksum</span>

                       <span class="n">STLVmWrFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;src_port&quot;</span><span class="p">,</span>
                                            <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;TCP.sport&quot;</span><span class="p">)</span> <span class="c"># fix udp len</span>

                      <span class="p">]</span>
                   <span class="p">)</span>

    <span class="n">pkt</span> <span class="o">=</span> <span class="n">STLPktBuilder</span><span class="p">(</span><span class="n">pkt</span> <span class="o">=</span> <span class="n">base_pkt</span><span class="p">,</span>
                        <span class="n">vm</span> <span class="o">=</span> <span class="n">vm</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">STLStream</span><span class="p">(</span><span class="n">packet</span> <span class="o">=</span> <span class="n">pkt</span><span class="p">,</span>
                     <span class="n">random_seed</span> <span class="o">=</span> <span class="mh">0x1234</span><span class="p">,</span><span class="c"># can be remove. will give the same random value any run</span>
                     <span class="n">mode</span> <span class="o">=</span> <span class="n">STLTXCont</span><span class="p">())</span>
</pre></div>
</div>
<div class="section" id="stlscvmraw-class">
<h2>STLScVmRaw class<a class="headerlink" href="#stlscvmraw-class" title="Permalink to this headline">¶</a></h2>
<p>Aggregate a raw instructions objects</p>
<dl class="class">
<dt id="trex_stl_lib.trex_stl_packet_builder_scapy.STLScVmRaw">
<em class="property">class </em><code class="descclassname">trex_stl_lib.trex_stl_packet_builder_scapy.</code><code class="descname">STLScVmRaw</code><span class="sig-paren">(</span><em>list_of_commands=None</em>, <em>split_by_field=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trex_stl_lib/trex_stl_packet_builder_scapy.html#STLScVmRaw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trex_stl_lib.trex_stl_packet_builder_scapy.STLScVmRaw" title="Permalink to this definition">¶</a></dt>
<dd><p>raw instructions</p>
</dd></dl>

</div>
<div class="section" id="stlvmflowvar">
<h2>STLVmFlowVar<a class="headerlink" href="#stlvmflowvar" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="trex_stl_lib.trex_stl_packet_builder_scapy.STLVmFlowVar">
<em class="property">class </em><code class="descclassname">trex_stl_lib.trex_stl_packet_builder_scapy.</code><code class="descname">STLVmFlowVar</code><span class="sig-paren">(</span><em>name</em>, <em>init_value=None</em>, <em>min_value=0</em>, <em>max_value=255</em>, <em>size=4</em>, <em>step=1</em>, <em>op='inc'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trex_stl_lib/trex_stl_packet_builder_scapy.html#STLVmFlowVar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trex_stl_lib.trex_stl_packet_builder_scapy.STLVmFlowVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Flow variable instruction. Allocate a variable on a stream context. The size of the variable could be determined 
The operation can be inc, dec and random. In case of increment and decrement operation, it is possible to set the &#8220;step&#8221; size.
Initialization value, minimum and maximum value could be set too.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt>name <span class="classifier-delimiter">:</span> <span class="classifier">string </span></dt>
<dd><p class="first last">The name of the stream variable</p>
</dd>
<dt>init_value <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The init value of the variable. in case of None it will be min_value</p>
</dd>
<dt>min_value <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The min value</p>
</dd>
<dt>max_value <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The max value</p>
</dd>
<dt>size <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of bytes of the variable. could be 1,2,4,8 for uint8_t, uint16_t, uint32_t, uint64_t</p>
</dd>
<dt>step <span class="classifier-delimiter">:</span> <span class="classifier">int </span></dt>
<dd><p class="first last">step in case of &#8220;inc&#8221;,&#8221;dec&#8221; operation</p>
</dd>
<dt>op <span class="classifier-delimiter">:</span> <span class="classifier">string </span></dt>
<dd><p class="first last">could be &#8220;inc&#8221;, &#8220;dec&#8221;, &#8220;random&#8221;</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper container" id="example1">
<div class="code-block-caption"><span class="caption-text">Example1</span><a class="headerlink" href="#example1" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># input </span>
<span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">op</span><span class="o">=</span><span class="s">&quot;inc&quot;</span><span class="p">)</span>

<span class="c"># output 0,1,2,3,0,1,2,3 ..</span>

<span class="c"># input </span>
<span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">op</span><span class="o">=</span><span class="s">&quot;dec&quot;</span><span class="p">)</span>

<span class="c"># output 0,3,2,1,0,3,2,1 ..</span>


<span class="c"># input </span>
<span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">op</span><span class="o">=</span><span class="s">&quot;random&quot;</span><span class="p">)</span>

<span class="c"># output 1,1,2,3,1,2,1,0 ..</span>

<span class="c"># input </span>
<span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">op</span><span class="o">=</span><span class="s">&quot;inc&quot;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c"># output 0,3,6,9,0,3,6,9,0..</span>
</pre></div>
</div>
</div>
</dd></dl>

</div>
<div class="section" id="stlvmwrmaskflowvar">
<h2>STLVmWrMaskFlowVar<a class="headerlink" href="#stlvmwrmaskflowvar" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="trex_stl_lib.trex_stl_packet_builder_scapy.STLVmWrMaskFlowVar">
<em class="property">class </em><code class="descclassname">trex_stl_lib.trex_stl_packet_builder_scapy.</code><code class="descname">STLVmWrMaskFlowVar</code><span class="sig-paren">(</span><em>fv_name</em>, <em>pkt_offset</em>, <em>pkt_cast_size=1</em>, <em>mask=255</em>, <em>shift=0</em>, <em>add_value=0</em>, <em>offset_fixup=0</em>, <em>is_big=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trex_stl_lib/trex_stl_packet_builder_scapy.html#STLVmWrMaskFlowVar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trex_stl_lib.trex_stl_packet_builder_scapy.STLVmWrMaskFlowVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a stream variable into a packet field with some operations. 
Using this instruction the variable size and the field could be with different size.</p>
<p>Pseudocode of this code:</p>
<div class="highlight-python"><div class="highlight"><pre>uint32_t val=(cast_to_size)rd_from_variable(&quot;name&quot;) # read flow-var
val+=m_add_value                                    # add value

if (m_shift&gt;0) {                                    # shift 
    val=val&lt;&lt;m_shift
}else{
    if (m_shift&lt;0) {
        val=val&gt;&gt;(-m_shift)
    }
}

pkt_val=rd_from_pkt(pkt_offset)                     # RMW to the packet
pkt_val = (pkt_val &amp; ~m_mask) | (val &amp; m_mask)
wr_to_pkt(pkt_offset,pkt_val)
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt>fv_name <span class="classifier-delimiter">:</span> <span class="classifier">string </span></dt>
<dd><p class="first last">The stream variable name to write to a packet field</p>
</dd>
<dt>pkt_cast_size <span class="classifier-delimiter">:</span> <span class="classifier">uint8_t </span></dt>
<dd><p class="first last">The size in bytes of the packet field</p>
</dd>
<dt>mask <span class="classifier-delimiter">:</span> <span class="classifier">uint32_t </span></dt>
<dd><p class="first last">The mask of the field. 1 means to write. 0 don&#8217;t care</p>
</dd>
<dt>shift <span class="classifier-delimiter">:</span> <span class="classifier">uint8_t </span></dt>
<dd><p class="first last">How many bits to shift</p>
</dd>
<dt>pkt_offset <span class="classifier-delimiter">:</span> <span class="classifier">string or in</span></dt>
<dd><p class="first last">the name of the field or offset in byte from packet start.</p>
</dd>
<dt>offset_fixup <span class="classifier-delimiter">:</span> <span class="classifier">int </span></dt>
<dd><blockquote class="first">
<div><p>how many bytes to go forward. In case of a negative value go backward</p>
</div></blockquote>
<dl class="last docutils">
<dt>add_val <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">value to add to stream variable before writing it to packet field. can be used as a constant offset</p>
</dd>
<dt>is_big <span class="classifier-delimiter">:</span> <span class="classifier">bool </span></dt>
<dd><p class="first last">how to write the variable to the the packet. is it big-edian or little edian</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>Example 1- casting from uint16_t (var) to uint8_t (pkt):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">base_pkt</span> <span class="o">=</span>  <span class="n">Ether</span><span class="p">()</span><span class="o">/</span><span class="n">IP</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">sport</span><span class="o">=</span><span class="mi">1025</span><span class="p">)</span>

<span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span> <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span> 
                                <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                <span class="n">max_value</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
                                <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                <span class="n">op</span><span class="o">=</span><span class="s">&quot;dec&quot;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
                   <span class="n">STLVmWrMaskFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span> 
                                      <span class="n">pkt_offset</span><span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
                                      <span class="n">pkt_cast_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">mask</span><span class="o">=</span><span class="mh">0xff</span><span class="p">)</span> <span class="c"># mask command -&gt;write it as one byte</span>
              <span class="p">]</span>
           <span class="p">)</span>

<span class="n">pkt</span> <span class="o">=</span> <span class="n">Ether</span><span class="p">()</span><span class="o">/</span><span class="n">IP</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">sport</span><span class="o">=</span><span class="mi">1025</span><span class="p">)</span>
</pre></div>
</div>
<p>Example 2- change MSB of uint16_t variable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span> <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span> 
                                <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                <span class="n">max_value</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
                                <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;dec&quot;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
                   <span class="n">STLVmWrMaskFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span> 
                                      <span class="n">pkt_offset</span><span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                      <span class="n">pkt_cast_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                      <span class="n">mask</span><span class="o">=</span><span class="mh">0xff00</span><span class="p">,</span>
                                      <span class="n">shift</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="c"># take the var shift it 8 (x256) write only to LSB</span>
                  <span class="p">]</span>
                <span class="p">)</span>
</pre></div>
</div>
<p>Example 3- Every 2 packet change the MAC (shift right):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span> <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span> 
                                <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                <span class="n">max_value</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
                                <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;dec&quot;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
                   <span class="n">STLVmWrMaskFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span> 
                                      <span class="n">pkt_offset</span><span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                      <span class="n">pkt_cast_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">mask</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span>
                                      <span class="n">shift</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c"># take var mac_src&gt;&gt;1 and write the LSB every two packet there should be a change</span>
                 <span class="p">]</span>
                <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="stlvmfixipv4">
<h2>STLVmFixIpv4<a class="headerlink" href="#stlvmfixipv4" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="trex_stl_lib.trex_stl_packet_builder_scapy.STLVmFixIpv4">
<em class="property">class </em><code class="descclassname">trex_stl_lib.trex_stl_packet_builder_scapy.</code><code class="descname">STLVmFixIpv4</code><span class="sig-paren">(</span><em>offset</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trex_stl_lib/trex_stl_packet_builder_scapy.html#STLVmFixIpv4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trex_stl_lib.trex_stl_packet_builder_scapy.STLVmFixIpv4" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix IPv4 header checksum. should be added if the packet header was changed and there is a need to fix he checksum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt>offset <span class="classifier-delimiter">:</span> <span class="classifier">uint16_t or string </span></dt>
<dd><p class="first last"><strong>IPv4 header</strong> offset from packet start. It is <strong>not</strong> the offset of the checksum field itself.
in could be string in case of scapy packet. format IP[:[id]]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper container" id="example2">
<div class="code-block-caption"><span class="caption-text">Example2</span><a class="headerlink" href="#example2" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pkt</span> <span class="o">=</span> <span class="n">Ether</span><span class="p">()</span><span class="o">/</span><span class="n">IP</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">sport</span><span class="o">=</span><span class="mi">1025</span><span class="p">)</span>

<span class="c"># by offset </span>
<span class="n">STLVmFixIpv4</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c"># in case of scapy packet can be defined by header name </span>
<span class="n">STLVmFixIpv4</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="s">&quot;IP&quot;</span><span class="p">)</span>

<span class="c"># string for second &quot;IP&quot; header in the packet is IP:1</span>
<span class="n">STLVmFixIpv4</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="s">&quot;IP:1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</div>
<div class="section" id="stlvmtrimpktsize">
<h2>STLVmTrimPktSize<a class="headerlink" href="#stlvmtrimpktsize" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="trex_stl_lib.trex_stl_packet_builder_scapy.STLVmTrimPktSize">
<em class="property">class </em><code class="descclassname">trex_stl_lib.trex_stl_packet_builder_scapy.</code><code class="descname">STLVmTrimPktSize</code><span class="sig-paren">(</span><em>fv_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trex_stl_lib/trex_stl_packet_builder_scapy.html#STLVmTrimPktSize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trex_stl_lib.trex_stl_packet_builder_scapy.STLVmTrimPktSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim packet size by stream variable size. This instruction will only change the total packet size and will not fix up the fields to match the new size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt>fv_name <span class="classifier-delimiter">:</span> <span class="classifier">string </span></dt>
<dd><p class="first last">the stream variable name. the value from this variable would be the new total packet size.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>For Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">create_stream</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># pkt </span>
    <span class="n">p_l2</span>  <span class="o">=</span> <span class="n">Ether</span><span class="p">();</span>
    <span class="n">p_l3</span>  <span class="o">=</span> <span class="n">IP</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span>
    <span class="n">p_l4</span>  <span class="o">=</span> <span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">sport</span><span class="o">=</span><span class="mi">1025</span><span class="p">)</span>
    <span class="n">pyld_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pkt_size_l3</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_l3</span><span class="o">/</span><span class="n">p_l4</span><span class="p">));</span>
    <span class="n">base_pkt</span> <span class="o">=</span> <span class="n">p_l2</span><span class="o">/</span><span class="n">p_l3</span><span class="o">/</span><span class="n">p_l4</span><span class="o">/</span><span class="p">(</span><span class="s">&#39;U&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">pyld_size</span><span class="p">))</span>

    <span class="n">l3_len_fix</span> <span class="o">=-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_l2</span><span class="p">));</span>
    <span class="n">l4_len_fix</span> <span class="o">=-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_l2</span><span class="o">/</span><span class="n">p_l3</span><span class="p">));</span>


    <span class="c"># vm</span>
    <span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span> <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;fv_rand&quot;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> 
                                    <span class="n">max_value</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">base_pkt</span><span class="p">),</span> 
                                    <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;inc&quot;</span><span class="p">),</span>

                       <span class="n">STLVmTrimPktSize</span><span class="p">(</span><span class="s">&quot;fv_rand&quot;</span><span class="p">),</span>                         <span class="c"># change total packet size &lt;&lt;&lt;</span>

                       <span class="n">STLVmWrFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;fv_rand&quot;</span><span class="p">,</span> 
                                      <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;IP.len&quot;</span><span class="p">,</span> 
                                      <span class="n">add_val</span><span class="o">=</span><span class="n">l3_len_fix</span><span class="p">),</span> <span class="c"># fix ip len </span>

                       <span class="n">STLVmFixIpv4</span><span class="p">(</span><span class="n">offset</span> <span class="o">=</span> <span class="s">&quot;IP&quot;</span><span class="p">),</span>                       <span class="c"># fix checksum</span>

                       <span class="n">STLVmWrFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;fv_rand&quot;</span><span class="p">,</span> 
                                      <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;UDP.len&quot;</span><span class="p">,</span> 
                                      <span class="n">add_val</span><span class="o">=</span><span class="n">l4_len_fix</span><span class="p">)</span> <span class="c"># fix udp len  </span>
                      <span class="p">]</span>
                   <span class="p">)</span>

    <span class="n">pkt</span> <span class="o">=</span> <span class="n">STLPktBuilder</span><span class="p">(</span><span class="n">pkt</span> <span class="o">=</span> <span class="n">base_pkt</span><span class="p">,</span>
                        <span class="n">vm</span> <span class="o">=</span> <span class="n">vm</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">STLStream</span><span class="p">(</span><span class="n">packet</span> <span class="o">=</span> <span class="n">pkt</span><span class="p">,</span>
                     <span class="n">mode</span> <span class="o">=</span> <span class="n">STLTXCont</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="stlvmtuplegen">
<h2>STLVmTupleGen<a class="headerlink" href="#stlvmtuplegen" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="trex_stl_lib.trex_stl_packet_builder_scapy.STLVmTupleGen">
<em class="property">class </em><code class="descclassname">trex_stl_lib.trex_stl_packet_builder_scapy.</code><code class="descname">STLVmTupleGen</code><span class="sig-paren">(</span><em>name</em>, <em>ip_min='0.0.0.1'</em>, <em>ip_max='0.0.0.10'</em>, <em>port_min=1025</em>, <em>port_max=65535</em>, <em>limit_flows=100000</em>, <em>flags=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trex_stl_lib/trex_stl_packet_builder_scapy.html#STLVmTupleGen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trex_stl_lib.trex_stl_packet_builder_scapy.STLVmTupleGen" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a struct with two varibles. <code class="docutils literal"><span class="pre">var_name.ip</span></code> as uint32_t and <code class="docutils literal"><span class="pre">var_name.port</span></code> as uint16_t 
The variable are dependent. When the ip variable is wrapped the port is getting increment.</p>
<p>For:</p>
<ul class="simple">
<li>ip_min      = 10.0.0.1</li>
<li>ip_max      = 10.0.0.5</li>
<li>port_min    = 1025</li>
<li>port_max    = 1028</li>
<li>limit_flows = 10</li>
</ul>
<p>The result:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="34%" />
<col width="31%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ip</th>
<th class="head">port</th>
<th class="head">flow_id</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>10.0.0.1</td>
<td>1025</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>10.0.0.2</td>
<td>1025</td>
<td>2</td>
</tr>
<tr class="row-even"><td>10.0.0.3</td>
<td>1025</td>
<td>3</td>
</tr>
<tr class="row-odd"><td>10.0.0.4</td>
<td>1025</td>
<td>4</td>
</tr>
<tr class="row-even"><td>10.0.0.5</td>
<td>1025</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>10.0.0.1</td>
<td>1026</td>
<td>6</td>
</tr>
<tr class="row-even"><td>10.0.0.2</td>
<td>1026</td>
<td>7</td>
</tr>
<tr class="row-odd"><td>10.0.0.3</td>
<td>1026</td>
<td>8</td>
</tr>
<tr class="row-even"><td>10.0.0.4</td>
<td>1026</td>
<td>9</td>
</tr>
<tr class="row-odd"><td>10.0.0.5</td>
<td>1026</td>
<td>10</td>
</tr>
<tr class="row-even"><td>10.0.0.1</td>
<td>1025</td>
<td>1</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt>name <span class="classifier-delimiter">:</span> <span class="classifier">string </span></dt>
<dd><p class="first last">The name of the stream struct.</p>
</dd>
<dt>ip_min <span class="classifier-delimiter">:</span> <span class="classifier">string or int </span></dt>
<dd><p class="first last">The min value of the ip value. It can be in IPv4 format</p>
</dd>
<dt>ip_max <span class="classifier-delimiter">:</span> <span class="classifier">string or int </span></dt>
<dd><p class="first last">The max value of the ip value. It can be in IPv4 format</p>
</dd>
<dt>port_min <span class="classifier-delimiter">:</span> <span class="classifier">int </span></dt>
<dd><p class="first last">min value for port variable</p>
</dd>
<dt>port_max <span class="classifier-delimiter">:</span> <span class="classifier">int </span></dt>
<dd><p class="first last">max value for port variable</p>
</dd>
<dt>limit_flows <span class="classifier-delimiter">:</span> <span class="classifier">int </span></dt>
<dd><p class="first last">The limit of number of flows</p>
</dd>
</dl>
<p>flags       : 0</p>
<p class="last">=&#8221;0.0.0.10&#8221;, port_min=1025, port_max=65535, limit_flows=100000, flags=0</p>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper container" id="example5">
<div class="code-block-caption"><span class="caption-text">Example5</span><a class="headerlink" href="#example5" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">create_stream</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># pkt </span>
    <span class="n">p_l2</span>  <span class="o">=</span> <span class="n">Ether</span><span class="p">();</span>
    <span class="n">p_l3</span>  <span class="o">=</span> <span class="n">IP</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span>
    <span class="n">p_l4</span>  <span class="o">=</span> <span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">sport</span><span class="o">=</span><span class="mi">1025</span><span class="p">)</span>
    <span class="n">pyld_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pkt_size_l3</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_l3</span><span class="o">/</span><span class="n">p_l4</span><span class="p">));</span>
    <span class="n">base_pkt</span> <span class="o">=</span> <span class="n">p_l2</span><span class="o">/</span><span class="n">p_l3</span><span class="o">/</span><span class="n">p_l4</span><span class="o">/</span><span class="p">(</span><span class="s">&#39;U&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">pyld_size</span><span class="p">))</span>

    <span class="n">l3_len_fix</span> <span class="o">=-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_l2</span><span class="p">));</span>
    <span class="n">l4_len_fix</span> <span class="o">=-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_l2</span><span class="o">/</span><span class="n">p_l3</span><span class="p">));</span>


    <span class="c"># vm</span>
    <span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span> <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;fv_rand&quot;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> 
                                    <span class="n">max_value</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">base_pkt</span><span class="p">),</span> 
                                    <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;inc&quot;</span><span class="p">),</span>

                       <span class="n">STLVmTrimPktSize</span><span class="p">(</span><span class="s">&quot;fv_rand&quot;</span><span class="p">),</span>                         <span class="c"># change total packet size &lt;&lt;&lt;</span>

                       <span class="n">STLVmWrFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;fv_rand&quot;</span><span class="p">,</span> 
                                      <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;IP.len&quot;</span><span class="p">,</span> 
                                      <span class="n">add_val</span><span class="o">=</span><span class="n">l3_len_fix</span><span class="p">),</span> <span class="c"># fix ip len </span>

                       <span class="n">STLVmFixIpv4</span><span class="p">(</span><span class="n">offset</span> <span class="o">=</span> <span class="s">&quot;IP&quot;</span><span class="p">),</span>                       <span class="c"># fix checksum</span>

                       <span class="n">STLVmWrFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;fv_rand&quot;</span><span class="p">,</span> 
                                      <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;UDP.len&quot;</span><span class="p">,</span> 
                                      <span class="n">add_val</span><span class="o">=</span><span class="n">l4_len_fix</span><span class="p">)</span> <span class="c"># fix udp len  </span>
                      <span class="p">]</span>
                   <span class="p">)</span>

    <span class="n">pkt</span> <span class="o">=</span> <span class="n">STLPktBuilder</span><span class="p">(</span><span class="n">pkt</span> <span class="o">=</span> <span class="n">base_pkt</span><span class="p">,</span>
                        <span class="n">vm</span> <span class="o">=</span> <span class="n">vm</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">STLStream</span><span class="p">(</span><span class="n">packet</span> <span class="o">=</span> <span class="n">pkt</span><span class="p">,</span>
                     <span class="n">mode</span> <span class="o">=</span> <span class="n">STLTXCont</span><span class="p">())</span>
</pre></div>
</div>
</div>
</dd></dl>

</div>
<div class="section" id="field-engine-snippet">
<h2>Field Engine snippet<a class="headerlink" href="#field-engine-snippet" title="Permalink to this headline">¶</a></h2>
<div class="literal-block-wrapper container" id="id1">
<div class="code-block-caption"><span class="caption-text">Example1</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">base_pkt</span> <span class="o">=</span> <span class="n">Ether</span><span class="p">()</span><span class="o">/</span><span class="n">IP</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">sport</span><span class="o">=</span><span class="mi">1025</span><span class="p">)</span>

    <span class="n">pad</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_pkt</span><span class="p">))</span> <span class="o">*</span> <span class="s">&#39;x&#39;</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span>   <span class="n">STLVmTupleGen</span> <span class="p">(</span> <span class="n">ip_min</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span> <span class="n">ip_max</span><span class="o">=</span><span class="s">&quot;16.0.0.2&quot;</span><span class="p">,</span>
                                         <span class="n">port_min</span><span class="o">=</span><span class="mi">1025</span><span class="p">,</span> <span class="n">port_max</span><span class="o">=</span><span class="mi">65535</span><span class="p">,</span>
                                         <span class="n">name</span><span class="o">=</span><span class="s">&quot;tuple&quot;</span><span class="p">),</span> <span class="c"># define tuple gen</span>

                         <span class="c"># write ip to packet IP.src</span>
                         <span class="n">STLVmWrFlowVar</span> <span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;tuple.ip&quot;</span><span class="p">,</span> <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;IP.src&quot;</span> <span class="p">),</span>

                         <span class="n">STLVmFixIpv4</span><span class="p">(</span><span class="n">offset</span> <span class="o">=</span> <span class="s">&quot;IP&quot;</span><span class="p">),</span>  <span class="c"># fix checksum</span>
                         <span class="n">STLVmWrFlowVar</span> <span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;tuple.port&quot;</span><span class="p">,</span> <span class="n">pkt_offset</span><span class="o">=</span> <span class="s">&quot;UDP.sport&quot;</span> <span class="p">)</span>  <span class="c">#write udp.port</span>
                              <span class="p">]</span>
                          <span class="p">);</span>

    <span class="n">pkt</span> <span class="o">=</span> <span class="n">STLPktBuilder</span><span class="p">(</span><span class="n">pkt</span> <span class="o">=</span> <span class="n">base_pkt</span><span class="o">/</span><span class="n">pad</span><span class="p">,</span>
                        <span class="n">vm</span> <span class="o">=</span> <span class="n">vm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="id2">
<div class="code-block-caption"><span class="caption-text">Example2</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre>    <span class="c">#range of source mac-addr</span>

    <span class="n">base_pkt</span> <span class="o">=</span>  <span class="n">Ether</span><span class="p">()</span><span class="o">/</span><span class="n">IP</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s">&quot;16.0.0.1&quot;</span><span class="p">,</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;48.0.0.1&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">sport</span><span class="o">=</span><span class="mi">1025</span><span class="p">)</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_pkt</span><span class="p">))</span> <span class="o">*</span> <span class="s">&#39;x&#39;</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">STLScVmRaw</span><span class="p">(</span> <span class="p">[</span> <span class="n">STLVmFlowVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span>
                                    <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">max_value</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                                    <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;dec&quot;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                       <span class="n">STLVmWrMaskFlowVar</span><span class="p">(</span><span class="n">fv_name</span><span class="o">=</span><span class="s">&quot;mac_src&quot;</span><span class="p">,</span>
                                          <span class="n">pkt_offset</span><span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
                                          <span class="n">pkt_cast_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                          <span class="n">mask</span><span class="o">=</span><span class="mh">0xff</span><span class="p">)</span>
                     <span class="p">]</span>
                    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Field Engine modules</a><ul>
<li><a class="reference internal" href="#stlscvmraw-class">STLScVmRaw class</a></li>
<li><a class="reference internal" href="#stlvmflowvar">STLVmFlowVar</a></li>
<li><a class="reference internal" href="#stlvmwrmaskflowvar">STLVmWrMaskFlowVar</a></li>
<li><a class="reference internal" href="#stlvmfixipv4">STLVmFixIpv4</a></li>
<li><a class="reference internal" href="#stlvmtrimpktsize">STLVmTrimPktSize</a></li>
<li><a class="reference internal" href="#stlvmtuplegen">STLVmTupleGen</a></li>
<li><a class="reference internal" href="#field-engine-snippet">Field Engine snippet</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="scapy_builder.html"
                        title="previous chapter">Packet builder modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/field_engine.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="scapy_builder.html" title="Packet builder modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TRex Stateless Python API 1.7.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >TRex Stateless API Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Cisco Systems Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>